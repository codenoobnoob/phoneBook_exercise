(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(14),r=n.n(a),o=n(3),c=n(2),s=n(0),i=function(e){var t=e.id,n=e.name,a=e.deleteFunction;return Object(s.jsx)("button",{id:t,"data-fullname":n,style:{marginLeft:5},onClick:a,children:"delete"})},u=function(e){var t=e.id,n=e.name,a=e.number,r=e.deletePerson;return Object(s.jsxs)("p",{children:[n," ",a,Object(s.jsx)(i,{id:t,name:n,deleteFunction:r})]})},d=function(e){var t=e.persons,n=e.filter,a=e.deletePerson,r=[];return t.forEach((function(e){(""===n||e.name.toLowerCase().includes(n.toLowerCase()))&&r.push(Object(s.jsx)(u,{id:e.id,name:e.name,number:e.number,deletePerson:a},e.name))})),r},l=function(e){var t=e.filter,n=e.handeleFilterChange;return Object(s.jsxs)("div",{children:["filter shown with: ",Object(s.jsx)("input",{value:t,onChange:n})]})},h=function(e){var t=e.newName,n=e.newNumber,a=e.handleNameChange,r=e.handeleNumberChange,o=e.addName;return Object(s.jsxs)("form",{onSubmit:o,children:[Object(s.jsx)("h2",{children:"add new contact"}),Object(s.jsxs)("div",{children:["name: ",Object(s.jsx)("input",{value:t,onChange:a})]}),Object(s.jsxs)("div",{children:["number: ",Object(s.jsx)("input",{value:n,onChange:r})]}),Object(s.jsx)("div",{children:Object(s.jsx)("button",{type:"submit",children:"add"})})]})},f={NotificationMessage:function(e){var t=e.message,n=e.isError;if(null!==t){if(n)return Object(s.jsx)("div",{className:"error",children:t});if(!n)return Object(s.jsx)("div",{className:"message",children:t})}return null},setMessageWithTimeout:function(e,t,n,a){n({message:e,isError:t}),setTimeout((function(){n({message:null,isError:!1})}),a)},errorMessage:function(e,t,n){n({message:e,isError:t})}},m=n(4),j=n.n(m),b="/api/persons",g={getData:function(){return j.a.get(b).then((function(e){return e.data}))},addData:function(e){return j.a.post(b,e).then((function(e){return console.log(e.data),e.data}))},updateData:function(e,t){return j.a.put("".concat(b,"/").concat(e),t).then((function(e){return e.data}))},removeData:function(e){return j.a.delete("".concat(b,"/").concat(e)).then((function(){return!0}))}},p=function(){var e=Object(c.useState)([]),t=Object(o.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),i=Object(o.a)(r,2),u=i[0],m=i[1],j=Object(c.useState)(""),b=Object(o.a)(j,2),p=b[0],v=b[1],O=Object(c.useState)(""),x=Object(o.a)(O,2),w=x[0],N=x[1],C=Object(c.useState)({message:null,isError:!1}),D=Object(o.a)(C,2),y=D[0],E=D[1];Object(c.useEffect)((function(){g.getData().then((function(e){a(e)})).catch((function(e){f.errorMessage("Could not connect to the server. Please check server connectivity and refresh the page! ".concat(e),!0,E)}))}),[]);return Object(s.jsxs)("div",{className:"mainWindow",children:[Object(s.jsx)("h1",{children:"Phonebook"}),Object(s.jsx)(f.NotificationMessage,{message:y.message,isError:y.isError},"messages"),Object(s.jsx)(l,{filter:w,handeleFilterChange:function(e){e.preventDefault(),N(e.target.value)}},"filter"),Object(s.jsx)(h,{newName:u,newNumber:p,handleNameChange:function(e){e.preventDefault(),m(e.target.value)},handeleNumberChange:function(e){e.preventDefault(),v(e.target.value)},addName:function(e){e.preventDefault();var t=null,r=!1,o=n.map((function(e){return e.name})).indexOf(u);if(-1!==o){if(window.confirm("".concat(u," is aleady added to phonebook, replace the old number with the new one?"))){t="".concat(u," phone number was changed");var c=n[o].id,s={name:u,number:p,id:c};g.updateData(n[o].id,s).then((function(e){return a(n.map((function(t){return t.id!==c?t:e})))})).catch((function(e){t="error while trying to update person",r=!0}))}}else{t="".concat(u," added to phonebook");var i={name:u,number:p};g.addData(i).then((function(e){console.log(e),a(n.concat(e))})).catch((function(e){t="error while trying to add person",r=!0}))}m(""),v(""),f.setMessageWithTimeout(t,r,E,5e3)}},"personform"),Object(s.jsx)("h2",{children:"Numbers"}),Object(s.jsx)(d,{persons:n,filter:w,deletePerson:function(e){e.preventDefault(),window.confirm("Are you sure you want to delete ".concat(e.target.dataset.fullname))&&g.removeData(e.target.id).then((function(t){t&&(a(n.filter((function(t){return t.id!==parseInt(e.target.id,10)}))),f.setMessageWithTimeout("Person ".concat(e.target.dataset.fullname," was removed from the server"),!1,E,5e3))})).catch((function(t){f.setMessageWithTimeout("Person ".concat(e.target.dataset.fullname," was already removed from the server, Please refresh the page."),!0,E,5e3)}))}},"persons")]})};n(38);r.a.render(Object(s.jsx)(p,{}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.2d525287.chunk.js.map